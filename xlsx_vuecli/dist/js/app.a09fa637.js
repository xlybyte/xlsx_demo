(function(e){function t(t){for(var n,l,s=t[0],u=t[1],c=t[2],i=0,d=[];i<s.length;i++)l=s[i],Object.prototype.hasOwnProperty.call(a,l)&&a[l]&&d.push(a[l][0]),a[l]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);p&&p(t);while(d.length)d.shift()();return o.push.apply(o,c||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,l=1;l<r.length;l++){var u=r[l];0!==a[u]&&(n=!1)}n&&(o.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={app:0},o=[];function l(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-0504cd0a":"59ab5eda"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r=a[e];if(0!==r)if(r)t.push(r[2]);else{var n=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=n);var o,u=document.createElement("script");u.charset="utf-8",u.timeout=120,s.nc&&u.setAttribute("nonce",s.nc),u.src=l(e);var c=new Error;o=function(t){u.onerror=u.onload=null,clearTimeout(i);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",c.name="ChunkLoadError",c.type=n,c.request=o,r[1](c)}a[e]=void 0}};var i=setTimeout((function(){o({type:"timeout",target:u})}),12e4);u.onerror=u.onload=o,document.head.appendChild(u)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=t,u=u.slice();for(var i=0;i<u.length;i++)t(u[i]);var p=c;o.push([1,"chunk-vendors"]),r()})({0:function(e,t){},1:function(e,t,r){e.exports=r("56d7")},2:function(e,t){},3:function(e,t){},5691:function(e,t,r){"use strict";r("f630")},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("h3",[e._v("EXCEL例子")]),r("hr"),r("excel"),r("div",[e._v("到底了")])],1)},o=[],l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard-container"},[r("div",{staticClass:"app-container"},[r("upload-excel-component",{attrs:{"on-success":e.handleSuccess,"before-upload":e.beforeUpload}}),r("el-button",{attrs:{type:"success",size:"small"},on:{click:e.exportExcelFn}},[e._v("导出excel")]),r("el-table",{attrs:{border:"",data:e.dataArr}},[r("el-table-column",{attrs:{label:"序号",type:"index"}}),r("el-table-column",{attrs:{label:"姓名",prop:"username"}}),r("el-table-column",{attrs:{label:"手机号",prop:"mobile",width:"120"}}),r("el-table-column",{attrs:{label:"工号",prop:"workNumber",sortable:"","sort-method":e.sortWorkNumberFn}}),r("el-table-column",{attrs:{label:"聘用形式",prop:"formOfEmployment"}}),r("el-table-column",{attrs:{label:"部门",prop:"departmentName"}}),r("el-table-column",{attrs:{label:"入职时间",prop:"timeOfEntry"}})],1)],1)])},s=[],u=r("1da1"),c=(r("96cf"),r("d3b7"),r("3ca3"),r("ddb0"),r("159b"),r("b64b"),r("d81d"),r("b0c0"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),r("div",{staticClass:"drop",on:{drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover}},[e._v(" 请将Excel文件拖到此处 "),r("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.handleUpload}},[e._v(" 选择文件 ")])],1)])}),i=[],p=(r("ac1f"),r("00b4"),r("1146")),d=r.n(p),f={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e){var t=e.header,r=e.results;this.excelData.header=t,this.excelData.results=r,this.onSuccess&&this.onSuccess(this.excelData)},handleDrop:function(e){if(e.stopPropagation(),e.preventDefault(),!this.loading){var t=e.dataTransfer.files;if(1===t.length){var r=t[0];if(!this.isExcel(r))return this.$message.error("Only supports upload .xlsx, .xls, .csv suffix files"),!1;this.upload(r),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")}},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files,r=t[0];r&&this.upload(r)},upload:function(e){if(this.$refs["excel-upload-input"].value=null,this.beforeUpload){var t=this.beforeUpload(e);t&&this.readerData(e)}else this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new Promise((function(r,n){var a=new FileReader;a.onload=function(e){var n=e.target.result,a=d.a.read(n,{type:"array"}),o=a.SheetNames[0],l=a.Sheets[o],s=t.getHeaderRow(l),u=d.a.utils.sheet_to_json(l);t.generateData({header:s,results:u}),t.loading=!1,r()},a.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,r=[],n=d.a.utils.decode_range(e["!ref"]),a=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var o=e[d.a.utils.encode_cell({c:t,r:a})],l="UNKNOWN "+t;o&&o.t&&(l=d.a.utils.format_cell(o)),r.push(l)}return r},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},m=f,h=(r("5691"),r("2877")),b=Object(h["a"])(m,c,i,!1,null,"3ce28eec",null),v=b.exports,g={components:{UploadExcelComponent:v},data:function(){return{tableData:[],tableHeader:[],dataArr:[]}},created:function(){console.log(r.e("chunk-0504cd0a").then(r.bind(null,"4bf8")))},methods:{beforeUpload:function(e){var t=e.size/1024/1024<1;return!!t||(this.$message({message:"请不要上传大小超过1m的文件.",type:"warning"}),!1)},handleSuccess:function(e){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function r(){var n,a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=e.results,a=e.header,t.tableData=n,t.tableHeader=a,console.log("header",a),console.log("results",n),o=t.transExcel(n),t.dataArr=o,console.log("转换格式",o);case 8:case"end":return r.stop()}}),r)})))()},transExcel:function(e){var t={"入职日期":"timeOfEntry","手机号":"mobile","姓名":"username","转正日期":"correctionTime","工号":"workNumber","部门":"departmentName","聘用形式":"formOfEmployment"},r=[];return e.forEach((function(e){var n={},a=Object.keys(e);a.forEach((function(r){var a=t[r];a&&(n[a]=e[r])})),r.push(n)})),r},sortWorkNumberFn:function(e,t){return e.workNumber-t.workNumber},exportExcelFn:function(){var e=this,t=[{key:"id",name:"编号"},{key:"username",name:"姓名"},{key:"staffPhoto",name:"头像地址"},{key:"mobile",name:"手机号"},{key:"workNumber",name:"工号"},{key:"formOfEmployment",name:"聘用形式"},{key:"departmentName",name:"部门"},{key:"timeOfEntry",name:"入职日期"}];r.e("chunk-0504cd0a").then(r.bind(null,"4bf8")).then((function(r){var n=e.dataArr,a=t.map((function(e){return e.name})),o=n.map((function(e,r){return t.map((function(t){return"id"===t.key?r+1:e[t.key]}))}));r.export_json_to_excel({header:a,data:o,filename:"xlsxxlsx",autoWidth:!0,bookType:"xlsx"})}))}}},x=g,y=Object(h["a"])(x,l,s,!1,null,null,null),k=y.exports,w={name:"App",components:{excel:k}},E=w,O=Object(h["a"])(E,a,o,!1,null,null,null),_=O.exports,D=r("5c96"),j=r.n(D);r("0fae");n["default"].use(j.a),n["default"].config.productionTip=!1,new n["default"]({render:function(e){return e(_)}}).$mount("#app")},f630:function(e,t,r){}});
//# sourceMappingURL=app.a09fa637.js.map